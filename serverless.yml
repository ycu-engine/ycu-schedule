service: ycu-schedule

custom:
  env:
    AZURE_CLIENT_ID: ${env.AZURE_CLIENT_ID}
    AZURE_CLIENT_SECRET: ${env.AZURE_CLIENT_SECRET}
    AZURE_TENANT_ID: ${env.AZURE_TENANT_ID}

YcuSchedule:
  component: './node_modules/@sls-next/serverless-component'
  inputs:
    domain: ycu-schedule.ycu-engine.dev
    domainType: www
    bucketName: ycu-schedule
    name: ycu-schedule
    cloudfront:
      distributionId: E286RN5HQFERMV
    build:
      env:
        AZURE_CLIENT_ID: ${custom.env.AZURE_CLIENT_ID}
        AZURE_CLIENT_SECRET: ${custom.env.AZURE_CLIENT_SECRET}
        AZURE_TENANT_ID: ${custom.env.AZURE_TENANT_ID}
        NEXTAUTH_URL: https://www.ycu-schedule.ycu-engine.dev

# YcuScheduleScrape:
#   component: '@serverless/aws-lambda'
#   inputs:
#     name: ycu-schedule-scrape
#     code: ./functions
#     handler: handlers.scrape.handler
#     env:
#       MICROSOFT_USER_2FA_SECRET: AAA
#     #   TABLE_NAME: my-table

#     # # if you'd like to include any shims
#     # shims:
#     #   - ../shims/shim.js

#     bucket: ycu-schedule

functions:
  scrape-data:
    handler: functions/handlers/scrape.handler
    environment:
      MICROSOFT_USER_2FA_SECRET: AAA
    # events:
    #   - schedule: cron(0 22 ? * SUN *)

plugins:
  - serverless-plugin-parcel
  - serverless-offline
